- content_for(:title) { "Edit: #{@user.name}" }

- user_p = present(@user)

%h1 Settings for #{user_p.link}

%hr

.card.mb-3
  .card-header
    %b Change your ozfortress.com name
  .card-body
    = bootstrap_form_for @name_change, url: name_user_path(@user),
                         method: :post, as: :name_change do |f|
      = f.text_field :name, hide_label: true

      = f.primary 'Request Name Change'

  .card-footer
    = inline_svg_tag 'open_iconic/document.svg', class: 'icon mr-2'
    %small We do not process name change requests until there are no current active seasonal leagues.

.card.mb-3
  .card-header
    %b Account Info
  .card-body
    = bootstrap_form_for @user, method: :patch do |f|
      = render('form', f:, user: @user, user_p:)

      .d-flex.justify-content-end
        = link_to 'Cancel', user_path(@user), class: 'btn btn-link mr-2'
        = f.primary 'Save'

  .card-footer
    = inline_svg_tag 'open_iconic/document.svg', class: 'icon mr-2'
    %small See our
    = link_to 'https://docs.ozfortress.com/rules/user_policy/', target: '_blank', rel: :noopener do
      %small User Policy
    %small
      for email privacy information. Your email is only used for website notifications,
      not for marketing/promotions.

- if user_can_edit_users?
  .card.border-danger.mb-3
    .card-header.text-white.bg-danger
      %b Admin Only
    .card-body
      %h5 User Management
      = bootstrap_form_for @user, method: :patch do |f|
        = render('admin_form', f:, user: @user, user_p:)

        .d-flex.justify-content-end
          = link_to 'Manage Bans', user_bans_path(@user), class: 'btn btn-warning mr-2'
          = link_to 'Logs', user_logs_path(@user), class: 'btn btn-warning mr-2'
          = link_to 'Cancel', user_path(@user), class: 'btn btn-link mr-2'
          = f.primary 'Save'

      %hr

    .card-body
      %h5 Send notification to #{@user.name}
      - notification = @user.notifications.new
      = bootstrap_form_for notification, url: user_notifications_path(user_id: @user.id), as: :notification,
                                         method: :post do |f|
        = render('users/notifications/form', f:)

        .d-flex.justify-content-end
          = link_to 'Cancel', user_path(@user), class: 'btn btn-link mr-2'
          = f.primary 'Send Notification'
